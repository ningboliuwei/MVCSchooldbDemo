@model MVCSchooldbDemo.Models.Data.PatientInfo

<div class="dialogTitle">@ViewBag.DialogTitle</div>
<form id="formPatient" method="post" class="easyui-form" data-options="novalidate:true">
    <div id="editorTabs" class="easyui-tabs" style="padding: 5px;">
        <div title="个人信息">
            <table id="test1" class="editorTable">
                <tr>
                    <th class="editorNameColumnStandard">
                        编号
                    </th>
                    <td>
                        <input id="编号" class="easyui-textbox" data-options="required:true, missingMessage:'请输入编号'" />
                    </td>
                    <th class="editorNameColumnStandard">
                        住院号
                    </th>
                    <td>
                        <input id="住院号" class="easyui-textbox" data-options="required:true, missingMessage:'请输入住院号'" />
                    </td>
                    <th class="editorNameColumnStandard">
                        姓名
                    </th>
                    <td>
                        <input id="姓名" class="easyui-textbox" data-options="required:true, missingMessage:'请输入姓名'" />
                    </td>
                </tr>
                <tr>
                    <th>
                        性别
                    </th>
                    <td>
                        <select id="性别" class="easyui-combobox editorInputComboBox"></select>
                    </td>
                    <th>
                        出生日期
                    </th>
                    <td>
                        <input id="出生日期" class="easyui-datebox" data-options="required:true, missingMessage:'请输入出生日期', validType:'date'" />
                    </td>
                    <th>
                        入组日期
                    </th>
                    <td>
                        <input id="入组日期" class="easyui-datebox" data-options="required:true, missingMessage:'请输入入组日期'" />
                    </td>
                </tr>
                <tr>
                    <th>
                        民族
                    </th>
                    <td>
                        <select id="民族" class="easyui-combobox editorInputComboBox"></select>
                    </td>
                    <th>
                        婚姻状况
                    </th>
                    <td>
                        <select id="婚姻状况" class="easyui-combobox editorInputComboBox"></select>
                    </td>
                    <th>
                        文化程度
                    </th>
                    <td>
                        <select id="文化程度" class="easyui-combobox editorInputComboBox"></select>
                    </td>
                </tr>
                <tr>
                    <th style="width: 80px">
                        职业
                    </th>
                    <td>
                        <select id="职业" class="easyui-combobox editorInputComboBox"></select>
                    </td>

                    <th>
                        年收入
                    </th>
                    <td>
                        <select id="年收入" class="easyui-combobox editorInputComboBox"></select>
                    </td>
                    <th>
                        保险类
                    </th>
                    <td>
                        <select id="保险类别" class="easyui-combobox editorInputComboBox"></select>
                    </td>
                </tr>
                <tr>
                    <th>
                        联系电话
                    </th>
                    <td>
                        <input id="联系电话" class="easyui-textbox" data-options="required:true, missingMessage:'请输入联系电话'" />
                    </td>
                    <th>
                        联系地址
                    </th>
                    <td colspan="3">
                        <input id="联系地址" class="easyui-textbox" style="width: 100%" data-options="required:true, missingMessage:'请输入联系地址'" />
                    </td>
                </tr>
            </table>
            <table class="editorTable">
                <tr>
                    <th class="editorNameColumnStandard">
                        住所至康复中心交通是否便利
                    </th>
                    <td>
                        <span id="住所至康复中心交通是否便利"></span>
                    </td>
                </tr>
                <tr>
                    <th>
                        是否参与工作
                    </th>
                    <td>
                        <span id="是否参与工作"></span>
                    </td>
                </tr>
                <tr>
                    <th>
                        <b>吸烟</b>
                    </th>
                    <td>
                        <span id="吸烟"></span>
                    </td>
                </tr>
                <tr>
                    <th>
                        药物不良反应
                    </th>
                    <td>
                        <span id="药物不良反应"></span>
                    </td>
                </tr>
                <tr>
                    <th>
                        目前的疾病
                    </th>
                    <td>
                        <span id="目前的疾病"></span>
                    </td>
                </tr>
            </table>
        </div>
        <div title="危险因素及用药">
            <table class="editorTable">
                <tr>
                    <th colspan="3">
                        危险因素及用药
                    </th>
                </tr>
                <tr>
                    <th rowspan="3">高血压</th>
                    <th>
                        是否有高血压
                    </th>
                    <td>
                        <span id="是否有高血压"></span>
                    </td>
                </tr>
                <tr>
                    <th>
                        控制情况
                    </th>
                    <td>
                        <span id="高血压控制情况"></span>
                    </td>
                </tr>
                <tr>
                    <th>
                        降压药物
                    </th>
                    <td>
                        <span id="降压药物"></span>
                    </td>
                </tr>
                <tr>
                    <th rowspan="3">糖尿病</th>
                    <th>
                        是否有糖尿病
                    </th>
                    <td>
                        <span id="是否有糖尿病"></span>
                    </td>
                </tr>
                <tr>
                    <th>
                        控制情况
                    </th>
                    <td>
                        <span id="糖尿病控制情况"></span>
                    </td>
                </tr>
                <tr>
                    <th>
                        降糖药物
                    </th>
                    <td>
                        <span id="降糖药物"></span>
                    </td>
                </tr>
                <tr>
                    <th rowspan="2">
                        血脂异常
                    </th>
                    <th>
                        是否存在血脂异常
                    </th>
                    <td>
                        <span id="是否存在血脂异常"></span>
                    </td>
                </tr>
                <tr>
                    <th>
                        降脂药物
                    </th>
                    <td>
                        <span id="降脂药物"></span>
                    </td>
                </tr>
                <tr>
                    <th>
                        抗血小板及抗凝药物
                    </th>
                    <td colspan="2">
                        <span id="抗血小板及抗凝药物"></span>
                    </td>
                </tr>
                <tr>
                    <th>
                        服药依从性
                    </th>
                    <td colspan="2">
                        <span id="服药依从性"></span>
                    </td>
                </tr>
            </table>
        </div>
        <div title="体格检查">
            <table class="editorTable">
                <tr>
                    <th>
                        执行时间
                    </th>
                    <td colspan="8">
                        <input id="体格检查执行时间" class="easyui-datetimebox" data-options="required:true, missingMessage:'请输入编号'" />
                    </td>
                </tr>
                <tr>
                    <th rowspan="3">
                        血压（mmHg）
                    </th>
                    <th>
                        收缩压1
                    </th>
                    <td>
                        <input id="收缩压1" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'请输入收缩压1'" />
                    </td>
                    <th>
                        舒张压1
                    </th>
                    <td>
                        <input id="舒张压1" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'请输入舒张压1'" />
                    </td>
                    <th>
                        收缩压2
                    </th>
                    <td>
                        <input id="收缩压2" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'请输入收缩压2'" />
                    </td>
                    <th>
                        舒张压2
                    </th>
                    <td>
                        <input id="舒张压2" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'请输入舒张压2'" />
                    </td>
                </tr>
                <tr>
                    <th>
                        收缩压3
                    </th>
                    <td>
                        <input id="收缩压3" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'请输入收缩压3'" />
                    </td>
                    <th>
                        舒张压3
                    </th>
                    <td>
                        <input id="舒张压3" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'请输入舒张压3'" />
                    </td>
                    <th>
                        平均收缩压
                    </th>
                    <td>
                        <input id="平均收缩压" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'请输入平均收缩压'" />
                    </td>
                    <th>
                        平均舒张压
                    </th>
                    <td>
                        <input id="平均舒张压" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'请输入平均舒张压'" />
                    </td>
                </tr>
                <tr>
                    <th>
                        心率（bmp）
                    </th>
                    <td>
                        <input id="心率" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'心率'" />
                    </td>
                    <th>
                        脉搏（bmp）
                    </th>
                    <td>
                        <input id="脉搏" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'请输入脉搏'" />
                    </td>
                    <th>
                        血氧饱和度（%）
                    </th>
                    <td>
                        <input id="血氧饱和度" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'血氧饱和度'" />
                    </td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <th rowspan="3">人体测量</th>
                    <th>身高（m）</th>
                    <td><input id="身高" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'身高'" /></td>
                    <th>体重（kg）</th>
                    <td><input id="体重" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'体重'" /></td>
                    <th>BMI</th>
                    <td><input id="BMI" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'BMI'" /></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <th>腰围</th>
                    <td><input id="腰围" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'腰围'" /></td>
                    <th>臀围</th>
                    <td><input id="臀围" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'臀围'" /></td>
                    <th>腰臀比</th>
                    <td><input id="腰臀比" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'腰臀比'" /></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <th colspan="3">握力(优势手 max + 非优势手 max)/2</th>
                    <td><input id="握力" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'腰围'" /></td>
                    <th colspan="1">脉搏波传播速度（cm/s）</th>
                    <td><input id="脉搏波传播速度" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'腰臀比'" /></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <th rowspan="5">人体分析</th>
                    <th>脂肪重量（kg）</th>
                    <td><input id="脂肪重量" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'脂肪重量'" /></td>
                    <th>脂肪占体重比（%）</th>
                    <td><input id="脂肪占体重比" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'脂肪占体重比'" /></td>
                    <th>骨质重量（kg）</th>
                    <td><input id="骨质重量" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'骨质重量'" /></td>
                    <th>骨质占体重比（%）</th>
                    <td><input id="骨质占体重比" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'骨质占体重比'" /></td>

                </tr>
                <tr>
                    <th>蛋白质重量（kg）</th>
                    <td><input id="蛋白质重量" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'蛋白质重量'" /></td>
                    <th>蛋白质占体重比（%）</th>
                    <td><input id="蛋白质占体重比" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'蛋白质占体重比'" /></td>
                    <th>水分重量（kg）</th>
                    <td><input id="水分重量" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'水分重量'" /></td>
                    <th>水分占体重比（%）</th>
                    <td><input id="水分占体重比" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'水分占体重比'" /></td>

                </tr>
                <tr>
                    <th>肌肉重量（kg）</th>
                    <td><input id="肌肉重量" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'肌肉重量'" /></td>
                    <th>内脏脂肪指数</th>
                    <td><input id="内脏脂肪指数" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'内脏脂肪指数'" /></td>
                    <th>基础代谢率</th>
                    <td><input id="基础代谢率" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'基础代谢率'" /></td>
                    <th>体脂率</th>
                    <td><input id="体脂率" class="easyui-textbox" style="width: 80px" data-options="required:true, missingMessage:'体脂率'" /></td>
                </tr>
                <tr><th>肺部</th><td colspan="7"><input id="肺部" class="easyui-textbox" style="width: 100%" data-options="required:true, missingMessage:'肺部'" /></td></tr>
                <tr><th>心脏</th><td colspan="7"><input id="心脏" class="easyui-textbox" style="width: 100%" data-options="required:true, missingMessage:'请输入心脏'" /></td></tr>
            </table>
        </div>
        <div Title="Tab3"></div>
    </div>
</form>
<script>
    $(function() {
        BindDataDictItemToCombobox('#性别', '性别', null);
        BindDataDictItemToCombobox('#婚姻状况', '婚姻状况', null);
        BindDataDictItemToCombobox('#职业', '职业', null);
        BindDataDictItemToCombobox('#年收入', '年收入', null);
        BindDataDictItemToCombobox('#文化程度', '文化程度', null);
        BindDataDictItemToCombobox('#保险类别', '保险类别', null);
        BindDataDictItemToCombobox('#民族', '民族', null);

        GenerateInputListByDataDictItem("#住所至康复中心交通是否便利", "住所至康复中心交通是否便利", InputType.Radio);
        GenerateInputListByDataDictItem("#是否参与工作", "是否参与工作", InputType.Radio);
        GenerateInputListByDataDictItem("#吸烟", "吸烟", InputType.Radio);
        GenerateInputListByDataDictItem("#药物不良反应", "药物不良反应", InputType.Radio);
        GenerateInputListByDataDictItem("#目前的疾病", "目前的疾病", InputType.Checkbox);
        GenerateInputListByDataDictItem("#是否有高血压", "是否有高血压", InputType.Radio);
        GenerateInputListByDataDictItem("#高血压控制情况", "高血压控制情况", InputType.Radio);
        GenerateInputListByDataDictItem("#降压药物", "降压药物", InputType.Radio);
        GenerateInputListByDataDictItem("#是否有糖尿病", "是否有糖尿病", InputType.Radio);
        GenerateInputListByDataDictItem("#糖尿病控制情况", "糖尿病控制情况", InputType.Radio);
        GenerateInputListByDataDictItem("#降糖药物", "降糖药物", InputType.Checkbox);
        GenerateInputListByDataDictItem("#是否存在血脂异常", "是否存在血脂异常", InputType.Radio);
        GenerateInputListByDataDictItem("#降脂药物", "降脂药物", InputType.Checkbox);
        GenerateInputListByDataDictItem("#抗血小板及抗凝药物", "抗血小板及抗凝药物", InputType.Radio);
        GenerateInputListByDataDictItem("#服药依从性", "服药依从性", InputType.Checkbox);

        $('#出生日期').datebox({ formatter: FormatHelper.FormatHelper });
        $('#入组日期').datebox({ formatter: FormatHelper.FormatHelper });

        $('#编号');
        $('#Patient_btnCancel')
            .bind('click',
                function() {
                    CloseEditor('#editorPatient');
                }
            );
    });

    function GetData() {
        return {
            编号: $('#编号').textbox('getText'),
            住院号: $('#住院号').textbox('getText'),
            姓名: $('#姓名').textbox('getText'),
            性别: $('#性别').combobox('getText'),
            出生日期: $('#出生日期').datebox('getText'),
            入组日期: $('#入组日期').datebox('getText'),
            民族: $('#民族').combobox('getText'),
            婚姻状况: $('#婚姻状况').combobox('getText'),
            文化程度: $('#文化程度').combobox('getText'),
            职业: $('#职业').textbox('getText'),
            年收入: $('#年收入').textbox('getText'),
            保险类别: $('#保险类别').combobox('getText'),
            联系电话: $('#联系电话').textbox('getText'),
            联系地址: $('#联系地址').textbox('getText')
        };
    }
</script>

@if (Model != null)
{
    <script>
        window.previousId = -1;
        window.nextId = -1;

        $(function() { ShowData(`@Url.Action("GetData", "Patient")/${@ViewBag.CurrentId}`); });

        function ShowData(url) {
            $.ajax({
                type: "POST",
                url: url,
                success: function(data) {
                    const item = data.Item;

                    $('#编号').textbox('setText', item.编号);
                    $('#住院号').textbox('setText', item.住院号);
                    $('#姓名').textbox('setText', item.姓名);
                    $('#性别').combobox('setText', item.性别);
                    $('#出生日期').datebox('setText', FormatHelper.DateBoxFormatter(item.出生日期));
                    $('#入组日期').datebox('setText', FormatHelper.DateBoxFormatter(item.入组日期));
                    $('#民族').combobox('setText', item.民族);
                    $('#婚姻状况').combobox('setText', item.婚姻状况);
                    $('#文化程度').combobox('setText', item.文化程度);
                    $('#职业').textbox('setText', item.职业);
                    $('#年收入').textbox('setText', item.年收入);
                    $('#保险类别').combobox('setText', item.保险类别);
                    $('#联系电话').textbox('setText', item.联系电话);
                    $('#联系地址').textbox('setText', item.联系地址);

                    console.log(item);

                    window.previousId = data.PreviousId;
                    window.nextId = data.NextId;
                },
                error: function() {
                    Alert("错误", 'error', AlertType.Error);
                },
                dataType: "json"
            });
        };


    </script>
}